{% extends 'portal/base.html' %}
{% block content %}
<article class="d-flex justify-content-between align-items-center mb-3">
    <h2>Мои заявки</h2>
    <a class="btn btn-primary" href="{% url 'portal:create_application' %}">Создать заявку</a>
</article>
<section class="table-responsive">
    <table class="table table-striped table-sm table-hover">
        <thead>
            <tr>
                <th>Курс</th>
                <th>Дата старта</th>
                <th>Оплата</th>
                <th>Статус</th>
                <th>Действия</th>
            </tr>
        </thead>
        <tbody>
            {% for app in applications %}
            <tr>
                <td>{{ app.course.name }}</td>
                <td>{{ app.start_date }}</td>
                <td>{{ app.get_payment_method_display }}</td>
                <td>{{ app.get_status_display }}</td>
                <td class="text-nowrap">
                    {% if app.feedback %}
                    <span class="text-success">Есть отзыв</span>
                    {% else %}
                    {% if app.status == 'completed' %}
                    <a class="btn btn-sm btn-outline-primary" href="{% url 'portal:add_feedback' app.id %}">Оставить
                        отзыв</a>
                    {% else %}
                    <span class="text-muted">Отзывы доступны после завершения обучения</span>
                    {% endif %}
                    {% endif %}
                </td>
            </tr>
            {% empty %}
            <tr>
                <td colspan="5">Заявок нет</td>
            </tr>
            {% endfor %}
        </tbody>
    </table>
</section>
{% endblock %}